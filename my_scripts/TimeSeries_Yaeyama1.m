%
% === Copyright (c) 2021 Takashi NAKAMURA  =====
%
% ----- YAEYAMA1 -----------
% grd='F:\COAWST_DATA\Yaeyama\Yaeyama1\Grid\Yaeyama1_grd_v10.nc';
% his=["H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_19940102.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_19950101.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_19960102.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_19970102.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_19980103.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_19990104.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20000104.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20010102.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20011231.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20021231.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20031221.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20040104.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20050104.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20060105.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20060302.nc"
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20070106.nc"      %<-Yaeyama1_his_20060302_00008.nc
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20080107.nc"      %<-Yaeyama1_his_20060302_00009.nc
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20080222.nc"      %<-Yaeyama1_his_20080222_00009.nc
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20090107.nc"      %<-Yaeyama1_his_20080222_00010.nc
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20100108.nc"      %<-Yaeyama1_his_20080222_00011.nc
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20110109.nc"      %<-Yaeyama1_his_20080222_00012.nc
%      "H:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20120110.nc"      %<-Yaeyama1_his_20080222_00013.nc
%      "F:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20130110.nc"      %<-Yaeyama1_his_20080222_00014.nc
%      "F:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20140111.nc"      %<-Yaeyama1_his_20080222_00015.nc
%      "F:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20150112.nc"      %<-Yaeyama1_his_20080222_00016.nc
%      "F:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20160113.nc"      %<-Yaeyama1_his_20080222_00017.nc
%      "F:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20170113.nc"      %<-Yaeyama1_his_20170113_00018.nc
%      "F:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20180114.nc"      %<-Yaeyama1_his_20170113_00019.nc
%      "F:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20180606.nc"      %<-Yaeyama1_his_20180606_00019.nc
%      "F:\COAWST_OUTPUT\Yaeyama1\Yaeyama1_his_20190115.nc"  ];  %<-Yaeyama1_his_20180606_00020.nc

% ----- YAEYAMA2 ------------
 
 grd='F:/COAWST_DATA/Yaeyama/Yaeyama2/Grid/Yaeyama2_grd_v11.2.nc';
 his=[  "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_19940110.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_19950110.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_19960110.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_19960731.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_19960802.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_19970801.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_19980801.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_19990801.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20000801.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20010731.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20020731.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20030731.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20040731.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20040823.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20040826.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20050718.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20060718.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20060915.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20060919.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20070917.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20070919.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20071003.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20071005.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20071008.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20080912.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20080914.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20090913.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20100402.nc"
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20110402.nc" %29
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20120401.nc" %30
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20120928.nc" %31
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20120930.nc" %32
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20130930.nc" %33
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20140930.nc" %34
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20150823.nc" %35
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20150825.nc" %36
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20150928.nc" %37
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20150930.nc" %38
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20160927.nc" %39
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20160929.nc" %40
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20170306.nc" %41
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20170913.nc" %42
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20170916.nc" %43
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20180916.nc" %44
        "E:/COAWTS_OUTPUT/Yaeyama2/Yaeyama2_his_20190916.nc" ]; %45

% i = 147; j = 136;  % YAEYAMA2; Monitouring buoy (24.3297, 124.03705) 
% i = 141; j = 150;  % YAEYAMA2; –kÊ 
% i = 174; j = 114;  % YAEYAMA2; “ì“Œ 
i = 142; j = 113;  % YAEYAMA2; “ì 

% ----- Air data -----------
% grd='F:\COAWST_DATA\Yaeyama\Yaeyama1\Grid\Yaeyama1_grd_v10.nc';
% his=["F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2011_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2012_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2013_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2014_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2015_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2016_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2017_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2018_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2019_Tair.nc"
%      "F:\COAWST_DATA\Yaeyama\Ishigak_Air\Ishigaki_frc_JMAobs_2020_Tair.nc"  ];
% i = 183; j = 83;  % YAEYAMA1; Center of the Sekisei lagoon
% his=["S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMnc_20110101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMnc_20120101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMnc_20130101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMnc_20140101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMnc_20150101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMnc_20160101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMgb_20170101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMgb_20180101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMgb_20190101_1.nc"
%      "S:\COAWST_DATA\Yaeyama\Yaeyama1\Air\Yaeyama1_frc_MSMgb_20200101_1.nc"  ];
% i = 190; j = 89;  % Ishigaki city
% ---------------------------

title='Temperature (^oC)'; cmin=16; cmax=32; colmap=jet(128); ncname='temp';
% title='Salinity (PSU)'; cmin=33; cmax=35; colmap=jet(128); ncname='salt';
% title='Short Wave radiation (W m^-^2)'; cmin=0; cmax=1000; colmap=jet(128); ncname='swrad';
% title='Temperature (^oC)'; cmin=16; cmax=32; colmap=jet(128); ncname='Tair';
depth = ncread(grd, 'h', [i j], [1 1])
rmask = ncread(grd, 'mask_rho', [i j], [1 1])
lonr = ncread(grd, 'lon_rho', [i j], [1 1])
latr = ncread(grd, 'lat_rho', [i j], [1 1])
% Nz=15;  % Surface
Nz=1;  % Bottom
% Nz=13;  % Surface + 2 layer

starting_date = datenum(2000,1,1,0,0,0);

time=[]; tmp=[];

%% Read data
for ihis=1:size(his,1)
    disp(ihis)
    time2 = ncread(his(ihis), 'ocean_time', 1, Inf);
%     time2 = ncread(his(ihis), 'time', 1, Inf);
    
    tmp2 = ncread(his(ihis), ncname, [i j Nz 1], [1 1 1 Inf]);  % 4D var
%     tmp2 = ncread(his(ihis), ncname, [i j 1], [1 1 Inf]);   % 3D vae
%     tmp2 = ncread(his(ihis), ncname, 1, Inf );   % 1D vae

    for idt=size(time,1):-1:1
        if(time(idt) < time2(1))
            break
        end
    end
    tmp2=squeeze(tmp2);
    time=[time(1:idt); time2];
    tmp =[tmp(1:idt); tmp2];
    clear tmp2;
end

%% plot figure
date=starting_date+time/24/60/60; %sec-> day
% date=starting_date+time; %day
% tmp3=squeeze(tmp);
fig1=figure;
plot(date, tmp);
% plot(date, tmp(1:size(date,1)));
datetick('x','dd-mmm-yyyy');
% annotation(fig1,'textbox',[0.6 0.01 0.3 0.05],'FitBoxToText','on','String','12M34567 NAKAMURA');
xlabel('Date')
ylabel(title)
ax = gca;
ax.XLim = [728000,738000];
ax.XTick = [datenum(1995,1,1,0,0,0),datenum(2000,1,1,0,0,0),datenum(2005,1,1,0,0,0),datenum(2010,1,1,0,0,0),datenum(2015,1,1,0,0,0),datenum(2020,1,1,0,0,0)];
ax.XTickLabel = ["01-Jan-1995","01-Jan-2000","01-Jan-2005","01-Jan-2010","01-Jan-2015","01-Jan-2020"];
%% Export CSV file
% csvwrite('Pair_MSM.csv',[time tmp]);
outfile=['Yaeyama2_', ncname, '_i=', num2str(i), '_j=', num2str(j), '_btm.csv'];
dlmwrite( outfile, [time tmp], 'precision', '%.4f', 'delimiter', ',')
